<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · GMMParameterEstimation.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>GMMParameterEstimation.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Examples"><span>Examples</span></a></li><li><a class="tocitem" href="#Parameter-estimation"><span>Parameter estimation</span></a></li><li><a class="tocitem" href="#Checking-Input-Formatting"><span>Checking Input Formatting</span></a></li><li><a class="tocitem" href="#Generate-and-sample-from-Gaussian-Mixture-Models"><span>Generate and sample from Gaussian Mixture Models</span></a></li><li><a class="tocitem" href="#Build-the-polynomial-systems"><span>Build the polynomial systems</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/HaleyColgateKottler/GMPE.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="GMMParameterEstimation.jl-Documentation"><a class="docs-heading-anchor" href="#GMMParameterEstimation.jl-Documentation">GMMParameterEstimation.jl Documentation</a><a id="GMMParameterEstimation.jl-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#GMMParameterEstimation.jl-Documentation" title="Permalink"></a></h1><p>Authors: Haley Colgate Kottler, Julia Lindberg, Jose Israel Rodriguez</p><p>GMMParameterEstimation.jl is a package for estimating the parameters of Gaussian k-mixture models using the method of moments. It can potentially find the parameters for arbitrary <code>k</code> with known or unknown mixing coefficients.  However, since the number of possible solutions to the polynomial system that determines the first dimension parameters and mixing coefficients for <span>$k&gt;4$</span> is unknown, for the unknown mixing coefficient case with <span>$k&gt;4$</span> failure of the package to find the parameters might occur if an insufficient number of solutions to the system were found</p><ul><li><a href="#GMMParameterEstimation.jl-Documentation">GMMParameterEstimation.jl Documentation</a></li><li class="no-marker"><ul><li><a href="#Examples">Examples</a></li><li><a href="#Parameter-estimation">Parameter estimation</a></li><li><a href="#Checking-Input-Formatting">Checking Input Formatting</a></li><li><a href="#Generate-and-sample-from-Gaussian-Mixture-Models">Generate and sample from Gaussian Mixture Models</a></li><li><a href="#Build-the-polynomial-systems">Build the polynomial systems</a></li><li><a href="#Index">Index</a></li></ul></li><li><a href="performanceMetrics/#Performance-Metrics">Performance Metrics</a></li><li class="no-marker"><ul><li><a href="performanceMetrics/#Error-Calculations">Error Calculations</a></li><li><a href="performanceMetrics/#Tests">Tests</a></li></ul></li></ul><h2 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h2><p>The following code snippet will use the given moments to return an estimate of the parameters using the method of moments with unknown mixing coefficients and dense covariance matrices.</p><pre><code class="language-julia hljs">using GMMParameterEstimation
d = 3
k = 2
first_moments = [1.0, -0.67, 2.44, -4.34, 17.4, -46.16, 201.67]
diagonal_moments = [-0.28 2.11 -2.46 15.29 -31.77; 0.4 4.25 3.88 54.75 59.10]
off_diag_system = Dict{Vector{Int64}, Float64}([2, 1, 0] =&gt; 1.8506, [1, 0, 1] =&gt; -0.329, [2, 0, 1] =&gt; 0.0291, [0, 2, 1] =&gt; 1.5869, [1, 1, 0] =&gt; -1.374, [0, 1, 1] =&gt; -0.333)
is_solution_found, (mixing_coefficients, means, covariances) = estimate_parameters(d, k, first_moments, diagonal_moments, off_diag_system)</code></pre><h3 id="Inputs:"><a class="docs-heading-anchor" href="#Inputs:">Inputs:</a><a id="Inputs:-1"></a><a class="docs-heading-anchor-permalink" href="#Inputs:" title="Permalink"></a></h3><ol><li><p>The number of dimensions <code>d</code></p></li><li><p>The number of mixture components <code>k</code></p></li><li><p>Optional: A vector of mixing coefficients <code>w</code> with length <code>k</code></p></li><li><p>A list of the first <span>$3k+1$</span> moments (including moment 0) of the first dimension as <code>first_moments</code></p></li><li><p>A matrix where row <code>i</code> contains the first <span>$2k+1$</span> moments (not including moment 0) of the <code>i</code>th dimension as <code>diagonal_moments</code></p></li><li><p>Optional: A dictionary mapping the index of a mixed dimensional moment as a list of integers to the corresponding moment <code>off_diag_system</code> (See <a href="https://haleycolgatekottler.github.io/GMMParameterEstimation.jl/#GMMParameterEstimation.mixedMomentSystem">mixedMomentSystem</a> for clarrification on which moments to include.)</p></li></ol><h3 id="Outputs:"><a class="docs-heading-anchor" href="#Outputs:">Outputs:</a><a id="Outputs:-1"></a><a class="docs-heading-anchor-permalink" href="#Outputs:" title="Permalink"></a></h3><ol><li><p>An indicator of success in finding the parameters <code>is_solution_found</code></p></li><li><p>A tuple of the parameters <code>(mixing_coefficients, means, covariances)</code> </p></li></ol><p><span>$\\~\\$</span></p><p>The following code snippet will generate the denoised moments necessary for parameter recovery from the given parameters.</p><pre><code class="language-julia hljs">using GMMParameterEstimation

d=3
k=2
diagonal = false

means = [0.83 0.24 -1.53; 0.22 0.04 -0.71]
covariances = [0.8828527552401668 0.27735188899130847 1.6710529671002674; 2.257873093006253 -1.644707016523332 -0.533030022431624;;; 0.27735188899130847 1.2623673813995742 3.5270452552353238; -1.644707016523332 2.577324062116896 -0.5049891831614162;;; 1.6710529671002674 3.5270452552353238 16.696895556824817; -0.533030022431624 -0.5049891831614162 1.7733508773418585]
mixing_coefficients = [.3, .7]

if diagonal
    true_first, true_diag = diagonalPerfectMoments(d, k, w, true_means, true_covariances)
else
    true_first, true_diag, true_others = densePerfectMoments(d, k, w, true_means, true_covariances)
end</code></pre><p><span>$\\~\\$</span></p><h2 id="Parameter-estimation"><a class="docs-heading-anchor" href="#Parameter-estimation">Parameter estimation</a><a id="Parameter-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-estimation" title="Permalink"></a></h2><p>The main functionality of this package stems from </p><article class="docstring"><header><a class="docstring-binding" id="GMMParameterEstimation.estimate_parameters" href="#GMMParameterEstimation.estimate_parameters"><code>GMMParameterEstimation.estimate_parameters</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">estimate_parameters(d::Integer, k::Integer, first::Vector{Float64}, second::Matrix{Float64}, last::Dict{Vector{Int64}, Float64}; method = &quot;recursive&quot;)</code></pre><p>Compute an estimate for the parameters of a <code>d</code>-dimensional Gaussian <code>k</code>-mixture model from the moments.</p><p>For the unknown mixing coefficient dense covariance matrix case, <code>first</code> should be a list of moments 0 through 3k for the first dimension, <code>second</code> should be a matrix of moments 1 through 2k+1 for the remaining dimensions, and <code>last</code> should be a dictionary of the indices as lists of integers and the corresponding moments.</p></div></section><section><div><pre><code class="nohighlight hljs">estimate_parameters(d::Integer, k::Integer, w::Array{Float64}, first::Vector{Float64}, second::Matrix{Float64}, last::Dict{Vector{Int64}, Float64}; method = &quot;recursive&quot;)</code></pre><p>Compute an estimate for the parameters of a <code>d</code>-dimensional Gaussian <code>k</code>-mixture model from the moments.</p><p>For the known mixing coefficient dense covariance matrix case, <code>w</code> should be a vector of the mixing coefficients <code>first</code> should be a list of moments 0 through 3k for the first dimension, <code>second</code> should be a matrix of moments 1 through 2k+1 for the remaining dimensions, and <code>last</code> should be a dictionary of the indices as lists of integers and the corresponding moments.</p></div></section><section><div><pre><code class="nohighlight hljs">estimate_parameters(d::Integer, k::Integer, first::Vector{Float64}, second::Matrix{Float64})</code></pre><p>Compute an estimate for the parameters of a <code>d</code>-dimensional Gaussian <code>k</code>-mixture model from the moments.</p><p>For the unknown mixing coefficient diagonal covariance matrix case, <code>first</code> should be a list of moments 0 through 3k for the first dimension, and <code>second</code> should be a matrix of moments 1 through 2k+1 for the remaining dimensions.</p></div></section><section><div><pre><code class="nohighlight hljs">estimate_parameters(d::Integer, k::Integer, w::Array{Float64}, first::Vector{Float64}, second::Matrix{Float64})</code></pre><p>Compute an estimate for the parameters of a <code>d</code>-dimensional Gaussian <code>k</code>-mixture model from the moments.</p><p>For the known mixing coefficient diagonal covariance matrix case, <code>w</code> should be a vector of the mixing coefficients <code>first</code> should be a list of moments 0 through 3k for the first dimension, and <code>second</code> should be a matrix of moments 1 through 2k+1 for the remaining dimensions.</p></div></section><section><div><pre><code class="nohighlight hljs">estimate_parameters(k::Integer, shared_cov::Matrix{Float64}, first::Vector{Float64}, second::Matrix{Float64}; method = &quot;recursive&quot;)</code></pre><p>Compute an estimate for the means of a Gaussian <code>k</code>-mixture model with equal mixing coefficients and known shared covariances from the moments.</p><p>The shared covariance matrix <code>shared_cov</code> will determine the dimension. Then <code>first</code> should be a list of moments 0 through k for the first dimension, <code>second</code> should be a matrix of moments <span>$m_{je_1+e_i}$</span> for j in 0 to <code>k</code>-1 and i in 2 to d as a matrix where d is the dimension, i varies across rows, and j varies down columns.</p></div></section></article><p>which computes the parameter recovery using Algorithm 1 from <a href="https://arxiv.org/abs/2106.15675">Estimating Gaussian Mixtures Using Sparse Polynomial Moment Systems</a>.  Note that the unknown mixing coefficient cases with <span>$k\in\{2,3,4\}$</span> load a set of generic moments and the corresponding solutions to the first 1-D polynomial system from <code>sys1_k2.jld2</code>, <code>sys1_k3.jld2</code>, or <code>sys1_k4.jld2</code> for a slight speedup.  If <code>k</code> is not specified, k=1 will be assumed, and the resulting polynomial system will be solved explicitly and directly.   </p><p>In one dimension, for a random variable <span>$X$</span> with density <span>$f$</span> define the <span>$i$</span>th moment as  <span>$m_i=E[X^i]=\int x^if(x)dx$</span>.   For a Gaussian mixture model, this results in a polynomial in the parameters.  For a sample <span>$\{y_1,y_2,\dots,y_N\}$</span>, define the <span>$i$</span>th sample moment as  <span>$\overline{m_i}=\frac{1}{N}\sum_{j=1}^N y_j^i$</span>.   The sample moments approach the true moments as <span>$N\rightarrow\infty$</span>, so by setting the polynomials equal to the empirical moments, we can then solve the polynomial system to recover the parameters.</p><p>For a multivariate random variable <span>$X$</span> with density <span>$f_X$</span> define the moments as  <span>$m_{i_1,\dots,i_n} = E[X_1^{i_1}\cdots X_n^{i_n}] = \int\cdots\int x_1^{i_1}\cdots x_n^{i_n}f_X(x_1,\dots,x_n)dx_1\cdots dx_n$</span>  and the empirical moments as  <span>$\overline{m}_{i_1,\dots,i_n} = \frac{1}{N}\sum_{j=1}^Ny_{j_1}^{i_1}\cdots y_{j_n}^{i_n}$</span>.   And again, by setting the polynomials equal to the empirical moments, we can then solve the system of polynomials to recover the parameters.  However, choosing which moments becomes more complicated.  If we know the mixing coefficients, we can use the first <span>$2k+1$</span> moments of each dimension to find the means and the diagonal entries of the covariance matrices.  If we do not know the mixing coefficients, we need the first <span>$3k$</span> moments of the first dimension to also find the mixing coefficients.  See <a href="https://haleycolgatekottler.github.io/GMMParameterEstimation.jl/#GMMParameterEstimation.mixedMomentSystem">mixedMomentSystem</a> for which moments to include to fill in the off-diagonals of the covariance matrices if needed.</p><p>On a standard laptop we have successfully recovered parameters with unknown mixing coefficients for <span>$k\leq 4$</span> and known mixing coefficients for <span>$k\leq 5$</span>, with <span>$d\leq 10^5$</span> for the diagonal covariance case and <span>$d\leq 50$</span> for the dense covariance case.  Higher <code>k</code> values or higher <code>d</code> values have led to issues with running out of RAM.</p><p><span>$\\~\\$</span></p><p>One potential difficulty in estimating the mixing coefficients is the resulting dependence on higher moments in the first dimension.  In sample data, if another dimension leads to more accurate moments, using that dimension to recover mixing coefficients and then proceeding can address this difficulty.  The following function was designed for this purpose.  Note that it can either be provided with an d x n sample, or a d x 3k+1 array of moments 0 through 3k for each dimension, augmented by a dictionary of the off-diagonal moments if seeking non-diagonal covariance matrices.</p><article class="docstring"><header><a class="docstring-binding" id="GMMParameterEstimation.dimension_cycle" href="#GMMParameterEstimation.dimension_cycle"><code>GMMParameterEstimation.dimension_cycle</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">dimension_cycle(d::Integer, k::Integer, cycle_moments::Array{Float64}, indexes::Dict{Vector{Int64}, Float64}; method = &quot;recursive&quot;)</code></pre><p>Cycle over the dimensions of <code>cycle_moments</code> to find candidate mixing coefficients, then solve for parameters based on those.</p><p>This will take longer than estimate_parameters since it does multiple tries.  Will try each dimension to attempt to find mixing coefficients, and if found will try to solve for parameters.  Returns <code>pass</code> = false if no dimension results in mixing coefficients that allow for a solution.  <code>cycle_moments</code> should be an array of the 0 through 3<code>k</code> moments for each dimension. If no <code>indexes</code> is given, assumes diagonal covariance matrices and a method should not be specified.</p></div></section></article><h2 id="Checking-Input-Formatting"><a class="docs-heading-anchor" href="#Checking-Input-Formatting">Checking Input Formatting</a><a id="Checking-Input-Formatting-1"></a><a class="docs-heading-anchor-permalink" href="#Checking-Input-Formatting" title="Permalink"></a></h2><p>To check you are formatting your inputs correctly, we have included</p><article class="docstring"><header><a class="docstring-binding" id="GMMParameterEstimation.checkInputs" href="#GMMParameterEstimation.checkInputs"><code>GMMParameterEstimation.checkInputs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">checkInputs(d::Integer, k::Integer, first::Vector{Float64}, second::Matrix{Float64}, last::Dict{Vector{Int64}, Float64}, method)</code></pre><p>Returns <code>true</code> if the inputs are the right format for <code>estimate_parameters</code> and an error otherwise.</p></div></section><section><div><pre><code class="nohighlight hljs">checkInputs(d::Integer, k::Integer, w::Vector{Float64}, first::Vector{Float64}, second::Matrix{Float64}, last::Dict{Vector{Int64}, Float64}, method)</code></pre></div></section><section><div><pre><code class="nohighlight hljs">checkInputs(d::Integer, k::Integer, first::Vector{Float64}, second::Matrix{Float64})</code></pre></div></section><section><div><pre><code class="nohighlight hljs">checkInputs(d::Integer, k::Integer, w::Vector{Float64}, first::Vector{Float64}, second::Matrix{Float64})</code></pre></div></section><section><div><pre><code class="nohighlight hljs">checkInputs(d::Integer, k::Integer, shared_cov::Matrix{Float64}, first::Vector{Float64}, second::Matrix{Float64}, method)</code></pre></div></section></article><h2 id="Generate-and-sample-from-Gaussian-Mixture-Models"><a class="docs-heading-anchor" href="#Generate-and-sample-from-Gaussian-Mixture-Models">Generate and sample from Gaussian Mixture Models</a><a id="Generate-and-sample-from-Gaussian-Mixture-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Generate-and-sample-from-Gaussian-Mixture-Models" title="Permalink"></a></h2><h3 id="Generation"><a class="docs-heading-anchor" href="#Generation">Generation</a><a id="Generation-1"></a><a class="docs-heading-anchor-permalink" href="#Generation" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="GMMParameterEstimation.makeCovarianceMatrix" href="#GMMParameterEstimation.makeCovarianceMatrix"><code>GMMParameterEstimation.makeCovarianceMatrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">makeCovarianceMatrix(d::Integer, diagonal::Bool)</code></pre><p>Generate random <code>d</code>x<code>d</code> covariance matrix.</p><p>If <code>diagonal</code>==true, returns a diagonal covariance matrix.</p></div></section></article><p>Note that the entries of the resulting covariance matrices are generated from a normal distribution centered at 0 with variance 1.</p><p><span>$\\~\\$</span></p><article class="docstring"><header><a class="docstring-binding" id="GMMParameterEstimation.generateGaussians" href="#GMMParameterEstimation.generateGaussians"><code>GMMParameterEstimation.generateGaussians</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">generateGaussians(d::Integer, k::Integer, diagonal::Bool)</code></pre><p>Generate means and covariances for <code>k</code> Gaussians with dimension <code>d</code>.</p><p><code>diagonal</code> should be true for spherical case, and false for dense covariance matrices.</p></div></section></article><p>The parameters are returned as a tuple, with weights in a 1D vector, means as a k x d array, and variances as a k x d x d array if <code>diagonal</code> is false or as a list of <code>Diagonal{Float64, Vector{Float64}}</code> if <code>diagonal</code> is true to save memory.  Note that each entry of each parameter is generated from a normal distribution centered at 0 with variance 1.</p><p><span>$\\~\\$</span></p><article class="docstring"><header><a class="docstring-binding" id="GMMParameterEstimation.getSample" href="#GMMParameterEstimation.getSample"><code>GMMParameterEstimation.getSample</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">getSample(numb::Integer, w::Vector{Float64}, means::Matrix{Float64}, covariances::Vector)</code></pre><p>Generate a Gaussian mixture model sample with <code>numb</code> entries, mixing coefficients <code>w</code>, means <code>means</code>, and covariances <code>covariances</code>.</p></div></section><section><div><pre><code class="nohighlight hljs">getSample(numb::Integer, w::Vector{Float64}, means::Matrix{Float64}, covariances::Array{Float64, 3})</code></pre><p>Generate a Gaussian mixture model sample with <code>numb</code> entries, mixing coefficients <code>w</code>, means <code>means</code>, and covariances <code>covariances</code>.</p></div></section></article><p>This relies on the <a href="https://juliastats.org/Distributions.jl/stable/">Distributions</a> package.</p><p><span>$\\~\\$</span></p><h3 id="Computing-moments"><a class="docs-heading-anchor" href="#Computing-moments">Computing moments</a><a id="Computing-moments-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-moments" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="GMMParameterEstimation.sampleMoments" href="#GMMParameterEstimation.sampleMoments"><code>GMMParameterEstimation.sampleMoments</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">sampleMoments(sample::Matrix{Float64}, k; diagonal = false)</code></pre><p>Use the sample to compute the moments necessary for parameter estimation using method of moments with general covariance matrices and mixing coefficients.</p><p>Returns moments 0 to 3k for the first dimension, moments 1 through 2k+1 for the other dimensions as a matrix, and a dictionary with indices and moments for the off-diagonal system if <code>diagonal</code> is false.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GMMParameterEstimation.diagonalPerfectMoments" href="#GMMParameterEstimation.diagonalPerfectMoments"><code>GMMParameterEstimation.diagonalPerfectMoments</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">diagonalPerfectMoments(d, k, w, true_means, true_covariances)</code></pre><p>Use the given parameters to compute the exact moments necessary for parameter estimation with diagonal covariance matrices.</p><p>Returns moments 0 to 3k for the first dimension, and moments 1 through 2k+1 for the other dimensions as a matrix.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GMMParameterEstimation.densePerfectMoments" href="#GMMParameterEstimation.densePerfectMoments"><code>GMMParameterEstimation.densePerfectMoments</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">densePerfectMoments(d, k, w, true_means, true_covariances; method = &quot;low&quot;)</code></pre><p>Use the given parameters to compute the exact moments necessary for parameter estimation with dense covariance matrices.</p><p>Returns moments 0 to 3k for the first dimension, moments 1 through 2k+1 for the other dimensions as a matrix, and a dictionary with indices and moments for the off-diagonal system.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GMMParameterEstimation.cycle_moments" href="#GMMParameterEstimation.cycle_moments"><code>GMMParameterEstimation.cycle_moments</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">cycle_moments(d, k, w, means, covars, diagonal)</code></pre><p>Calculate 0 through 3<code>k</code>+1 denoised moments for every dimension.</p><p>Used as input for cycling over the dimensions to find candidate mixing coefficients.</p></div></section><section><div><pre><code class="nohighlight hljs">cycle_moments(k, sample, diagonal, style)</code></pre><p>Calculate 0 through 3<code>k</code>+1 sample moments for every dimension.</p><p>Used as input for cycling over the dimensions to find candidate mixing coefficients.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="GMMParameterEstimation.equalMixCovarianceKnown_moments" href="#GMMParameterEstimation.equalMixCovarianceKnown_moments"><code>GMMParameterEstimation.equalMixCovarianceKnown_moments</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">equalMixCovarianceKnown_moments(k, mean, shared_cov)</code></pre><p>Use the given parameters to compute the exact moments necessary for parameter estimation with equal mixing coefficients and shared known covariances.</p><p>Returns moments 0 to <code>k</code> for the first dimension, and moments <code>math m\_{je\_1+e\_i}</code> for j in 0 to <code>k</code>-1 and i in 2 to d as a matrix where d is the dimension, i varies across rows, and j varies down columns.</p></div></section><section><div><pre><code class="nohighlight hljs">equalMixCovarianceKnown_moments(k, sample)</code></pre><p>Use the given parameters to compute the sample moments necessary for parameter estimation with equal mixing coefficients and shared known covariances.</p><p>Returns moments 0 to <code>k</code> for the first dimension, and moments m<em>{je</em>1+e_i} for j in 0 to <code>k</code>-1 and i in 2 to d as a matrix where d is the dimension, i varies across rows, and j varies down columns.</p></div></section></article><p>These expect parameters to be given with weights in a 1D vector, means as a k x d array, and covariances as a k x d x d array for dense covariance matrices or as a list of diagonal matrices for diagonal covariance matrices.</p><p><span>$\\~\\$</span></p><h2 id="Build-the-polynomial-systems"><a class="docs-heading-anchor" href="#Build-the-polynomial-systems">Build the polynomial systems</a><a id="Build-the-polynomial-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Build-the-polynomial-systems" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="GMMParameterEstimation.build1DSystem" href="#GMMParameterEstimation.build1DSystem"><code>GMMParameterEstimation.build1DSystem</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">build1DSystem(k::Integer, m::Integer)</code></pre><p>Build the polynomial system for a mixture of 1D Gaussians where &#39;m&#39;-1 is the highest desired moment and the mixing coefficients are unknown.</p></div></section><section><div><pre><code class="nohighlight hljs">build1DSystem(k::Integer, m::Integer, a::Union{Vector{Float64}, Vector{Variable}})</code></pre><p>Build the polynomial system for a mixture of 1D Gaussians where &#39;m&#39;-1 is the highest desired moment, and <code>a</code> is a vector of the mixing coefficients.</p></div></section></article><p>This uses the usual recursive formula for moments of a univariate Gaussian in terms of the mean and variance, and then takes a convex combination with either variable mixing coefficients or the provided mixing coefficients.</p><p><span>$\\~\\$</span></p><p>The final step in our method of moments parameter recovery for non-diagonal covariance matrices is building and solving a system of <span>$N:=\frac{k}{2}(d^2-d)$</span> linear equations in the same number of unknowns to fill in the off diagonal.</p><p>We present two options for moment selection.  First, Lindberg et al., demonstrated that for fixed <span>$i,j\in[d]$</span>, <span>$i\neq j$</span>, the set of moment equations <span>$\{m_{te_i+e_j}\}_{t=1}^k$</span> are linear in <span>$\sigma_{\ell i j}$</span> for <span>$\ell\in[k]$</span> and leads to a linear system that generically has a unique solution.  Due to the symmetry of covariance matrices (<span>$\sigma_{\ell i j}=\sigma_{\ell j i}$</span>) we add the restriction that <span>$i&lt;j$</span>. This is implemented and can be selected by setting <code>style=&quot;k&quot;</code>.</p><p>Second, further relying on the symmetry of the covariance matrices and their corresponding polynomials, we present a lower order system given by <span>$\begin{cases} \{m_{te_i+e_j}, m_{e_i+te_j}\}_{t=1}^{\frac{k}{2}}\cup\{m_{te_i+e_j}\}_{t=1}^{\frac{k}{2}+1} &amp; \text{ if k is even}\\ \{m_{te_i+e_j}, m_{e_i+te_j}\}_{t=1}^{\frac{k+1}{2}} &amp; \text{ if k is odd}\end{cases}.$</span></p><p>We again assume <span>$i,j\in[d]$</span> with <span>$i&lt;j$</span>. This is the default setting and can be selected by setting <code>style=&quot;low&quot;</code>.</p><p>We also present two methods for generating the moment polynomials. First, we use tensor moments. Referring to <a href="https://arxiv.org/abs/2202.06930">Pereira et al.</a> for a closed form method of generating the necessary moment polynomials, we generate the linear system using the already computed mixing coefficients, means, and diagonals of the covariances, and return it as a dictionary of index=&gt;polynomial pairs that can then be matched with the corresponding moments. This can be accessed by selecting <code>method=&quot;tensor&quot;</code> and uses the lower order system due to difficulties with higher order tensor moments.</p><p>Second, we use a recursive method, which is the default because it is faster, and can be selected via <code>method=&quot;recursive&quot;</code>.</p><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#GMMParameterEstimation.build1DSystem"><code>GMMParameterEstimation.build1DSystem</code></a></li><li><a href="#GMMParameterEstimation.checkInputs"><code>GMMParameterEstimation.checkInputs</code></a></li><li><a href="#GMMParameterEstimation.cycle_moments"><code>GMMParameterEstimation.cycle_moments</code></a></li><li><a href="#GMMParameterEstimation.densePerfectMoments"><code>GMMParameterEstimation.densePerfectMoments</code></a></li><li><a href="#GMMParameterEstimation.diagonalPerfectMoments"><code>GMMParameterEstimation.diagonalPerfectMoments</code></a></li><li><a href="#GMMParameterEstimation.dimension_cycle"><code>GMMParameterEstimation.dimension_cycle</code></a></li><li><a href="#GMMParameterEstimation.equalMixCovarianceKnown_moments"><code>GMMParameterEstimation.equalMixCovarianceKnown_moments</code></a></li><li><a href="#GMMParameterEstimation.estimate_parameters"><code>GMMParameterEstimation.estimate_parameters</code></a></li><li><a href="#GMMParameterEstimation.generateGaussians"><code>GMMParameterEstimation.generateGaussians</code></a></li><li><a href="#GMMParameterEstimation.getSample"><code>GMMParameterEstimation.getSample</code></a></li><li><a href="#GMMParameterEstimation.makeCovarianceMatrix"><code>GMMParameterEstimation.makeCovarianceMatrix</code></a></li><li><a href="#GMMParameterEstimation.sampleMoments"><code>GMMParameterEstimation.sampleMoments</code></a></li></ul></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Tuesday 1 August 2023 15:39">Tuesday 1 August 2023</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
